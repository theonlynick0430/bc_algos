{
    "experiment": {
        "name": "bc_transformer",
        "ouput_dir": null,
        "valid_rate": 1,
        "save_rate": 50, 
        "rollout_rate": 10
    },

    "train": {
        "epochs": 100,
        "batch_size": 64, 
        "loss": "L2",
        "lr": 1e-5,
        "weight_decay": 1e-5,
        "betas": [0.9, 0.999]
    },

    "observation": {
        "shapes": {
            "robot0_eef_pos": [3],
            "robot0_eef_quat": [4],
            "agentview_image": [3, 256, 256]
        },
        "modalities": {
            "obs": {
                "low_dim": [
                    "robot0_eef_pos",
                    "robot0_eef_quat"
                ],
                "rgb": ["agentview_image"]
            },
            "goal": {
                "low_dim": [],
                "rgb": []
            }
        },
        "kwargs": {
            "low_dim": {
                "output_shape": [512],
                "hidden_dims": []
            },
            "rgb": {}
        }
    },

    "dataset": {
        "type": "robomimic",
        "path": "/Users/nikhilsridhar/Desktop/RoboDev/JJ/bc_algos/datasets/test/square_ph.hdf5",
        "dataset_keys": [
            "actions"
        ],
        "frame_stack": 3,
        "seq_length": 10,
        "pad_frame_stack": true,
        "pad_seq_length": true,
        "get_pad_mask": false,
        "goal_mode": null,
        "num_subgoal": null,
        "kwargs": {
            "train": {
                "filter_by_attribute": "train",
                "demos": null
            },
            "valid": {
                "filter_by_attribute": "valid",
                "demos": ["demo_1", "demo_2", "demo_3", "demo_4", "demo_6", "demo_0", "demo_5", "demo_14", "demo_21", "demo_27"]
            }
        }
    },

    "policy": {
        "type": "transformer",
        "embed_dim": 512,
        "action_shape": [7],
        "kwargs": {
            "backbone": {
                "num_encoder_layers": 4,
                "num_decoder_layers": 7,
                "nhead": 8,
                "dim_feedforward": 3200
            },
            "action_decoder": {}
        }
    },

    "rollout": {
        "type": "robomimic",
        "horizon": null,
        "render_video": false
    }
}